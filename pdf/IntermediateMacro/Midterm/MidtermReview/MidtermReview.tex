\documentclass[11pt,aspectratio=169,usenames,dvipsnames]{beamer}
\usetheme[numbering=fraction]{metropolis} % Use Metropolis theme

\usepackage[T1]{fontenc}
\usepackage[cache=true]{minted} % for code chuck and syntax highlighting
%% shortcuts for julia code chuck

%% adjusting margin
\setbeamersize{text margin left=5mm,text margin right=5mm}

\usepackage{xcolor} % For custom colors
\usepackage{tikz} % For styling enumerate numbers
\usepackage{tcolorbox} % For colored box styling
\usepackage{amsmath, amsfonts, amssymb, amsthm} % Math related
\usepackage{natbib}
\usepackage{appendixnumberbeamer}

% ---------------- %
% color definition %
% ---------------- %
\definecolor{main}{HTML}{23373B}
\definecolor{pink}{RGB}{180, 50, 110}
\definecolor{orange}{HTML}{FF8000}
\definecolor{red}{HTML}{990000}
\definecolor{blue}{HTML}{004C99}
\definecolor{lightgray}{HTML}{E7E7E7}
\definecolor{gray}{RGB}{90, 90, 90}

\newcommand{\pink}[1]{\textcolor{pink}{#1}}
\newcommand{\orange}[1]{\textcolor{orange}{#1}}
\newcommand{\red}[1]{\textcolor{red}{#1}}
\newcommand{\blue}[1]{\textcolor{blue}{#1}}

\setbeamercolor{alerted text}{fg=blue}

% Apply Custom Colors
\setbeamercolor{frametitle}{fg=main, bg=lightgray}
\setbeamercolor{section title}{fg=gray}
\setbeamercolor{title}{fg=main}
\setbeamercolor{structure}{fg=main}
\setbeamercolor{item}{fg=main}

% --------------------------------- %
% enumerate and itemize environment %
% --------------------------------- %
% \setbeamertemplate{enumerate item}{%
%     {\color{white}\fcolorbox{pink}{pink}{{\arabic{enumi}}}}%
% }

% Customize enumerate numbering using TikZ
\setbeamertemplate{enumerate item}{%
    \tikz[baseline=(char.base)]{
        \node[shape=rectangle, rounded corners=3pt, fill=pink, inner sep=2pt,
              text width=1.2em, align=center] (char)
              {\color{white}\textbf{\arabic{enumi}}}}%
}

\setbeamertemplate{itemize item}{\color{red}\small$\blacktriangleright$}

%%% automatically add spaces into enumerate and itemize environment
\let\tempone\itemize
\let\temptwo\enditemize
\renewenvironment{itemize}{\tempone\addtolength{\itemsep}{\fill}}{\temptwo}
\let\tempa\enumerate
\let\tempb\endenumerate
\renewenvironment{enumerate}{\tempa\addtolength{\itemsep}{\fill}}{\tempb}

% --------------------------------- %
% Font: Fira Sans with light weight %
% --------------------------------- %
\usepackage[light,sfdefault]{FiraSans} % Use Fira Sans Light as default sans-serif
\usepackage{FiraMono} % Use Fira Mono for monospaced text
\renewcommand*\familydefault{\sfdefault}
\makeatletter
\def\bfseries@sf{medium}
\def\mdseries@sf{light}
\def\mathfamilydefault{cmss}
\makeatother

% --------------------------- %
% Section title page with toc %
% --------------------------- %
\setbeamertemplate{section in toc}[square]
\setbeamertemplate{subsection in toc}[square]
\AtBeginSection[]{
\begin{frame}[noframenumbering]{Outline}
    % \tableofcontents[currentsection]
    \tableofcontents[currentsection, currentsubsection]
\end{frame}
}
\AtBeginSubsection[]{
  \begin{frame}[noframenumbering]{Outline}
    \tableofcontents[currentsection, currentsubsection]
  \end{frame}
}

% ------------ %
% beamerbutton %
% ------------ %
\newcommand{\goto}[2]{\hyperlink{#2}{\beamergotobutton{#1}}}
\newcommand{\return}[2]{\hyperlink{#2}{\beamerreturnbutton{#1}}}
\newcommand{\extgoto}[2]{\href{#2}{\beamergotobutton{#1}}}

\title{Intermediate Macroeconomics Theory \\ \normalsize Midterm Review}
\author{Hui-Jun Chen}
\institute{The Ohio State University}
\date{\today}

\begin{document}

% Title Page
\begin{frame}
    \titlepage
\end{frame}

\section{Competitive Equilibrium and Social Planner's Problem}
\label{sec:Competitive_Equilibrium_and_Social_Planner_s_Problem}

\begin{frame}{Review of the CE and SPP}
\label{slide:Review_of_the_CE_and_SPP}
    \begin{enumerate}
        \item Competitive Equilibrium (CE) allows all agents to solve their own problems, given \alert{exogenous variables} and \alert{variables determined by other agents}
        \item Social Planner's Problem (SPP) imposes a \alert{benevolent} social planner that can directly \alert{dictate the allocation of variables}, no trade occurs.
        \begin{itemize}
            \item The \alert{most efficient} outcome by design
            \item Social planner only cares about \alert{aggregates}: individuals add up to be aggregate
        \end{itemize}
        \item When certain condition holds, CE will be as efficient as SPP
    \end{enumerate}
\end{frame}


\begin{frame}{Environment}
\label{slide:Environment}

\begin{enumerate}
    \item Utility function is CRRA: $ \frac{C^{1-b}}{1-b} + \frac{l^{1-d}}{1-d} $
    \item Firm rent capital from consumer, and consumer is endowed with $ 2 $ unit of capital
    \item Production function is Cobb-Douglas: $ F(K, N) = K^{a} N^{1-a}$
    \item TFP $ z = 1 $; consumer is endowed with (1) time $ h = 1 $ and (2) capital $ K^{s} = 2 $
\end{enumerate}

\end{frame}

\begin{frame}{Definition of Competitive Equilibrium}
\label{slide:Definition_of_Competitive_Equilibrium}
    Underlined part is new

    A \alert{competitive equilibrium} given \alert{$ \{ G, z, \underline{K^{s}} \} $} is a set of allocations \red{$ \{ Y^{*}, C^{*}, l^{*}, N^{s*}, N^{d*}, \pi^{*}, T^{*}, \underline{K^{d*}} \}$} and prices $ \orange{\{ w^{*}, \underline{r^{*}} \}} $ such that
    \begin{enumerate}
        \item Taken prices \orange{$w, r$} and \orange{$\pi, T$} as given, representative consumer solves
        %
        \begin{equation}
        \label{eq:consumer_problem}
            \max_{\red{C}, \red{l} \in [ 0, \alert{h} ]} U( \red{C, l} ) \quad \text{ subject to } \quad \red{C} \le \orange{w} ( \alert{h} - \red{l} ) + \red{\underline{r K^{s}}} + \orange{\pi} - \orange{T}
        \end{equation}
        %
        \item Taken prices \orange{$w, r$} as given, the representative firm solves
        %
        \begin{equation}
        \label{eq:firm_problem}
            \max_{\red{N^{d}, K^{d}} \ge 0} \alert{z} F( \alert{K}, \red{N^{d}} ) - \orange{w} \red{N^{d}} - \underline{\orange{r} \red{K^{d}}}
        \end{equation}
        %
        \item Government set taxes to balance budget: $ \red{T^{*}} = \alert{G} $
        \item Labor market clears: $ \red{w^{*}} $ such that $ \red{N^{s*} = N^{d*}} $
        \item \underline{Capital market clears: $ \red{r^{*}} $ such that $ \red{K^{s} = K^{d*}} $}
    \end{enumerate}
\end{frame}

\begin{frame}{Optimality Conditions}
\label{slide:Optimality_Conditions}
    Solve for firms' problem, you get the optimality conditions for $ N^{d} $ and $ K^{d} $,
    %
    \begin{align}
        w
            & = MPN = z K^{a} (1 - a) N^{-a}
        \\
        r
            & = MPK = z N^{1-a} a K^{a-1}
    \end{align}
    %

\end{frame}


\begin{frame}{Rewrite CE into SPP}
\label{slide:Rewrite_CE_into_SPP}
    \begin{itemize}
        \item Welfare theorem holds, so CE allocation is as efficient as SPP
        \item Social planner cares about \alert{aggregate resources} and \alert{technological constraint}
        %
        \begin{align}
                \max_{C, l, N, Y, \underline{K}} \quad
                    & U( C( l ), l ) = \frac{C( l )^{1-b}}{1-b} + \frac{l^{1-d}}{1-d}
                    \tag{utility function}
                \\
                \text{s.t.} \quad
                    & C = Y - G
                    \tag{aggregate resource constraint}
                \\
                    & Y = z K^{a}N^{1-a}
                    \tag{production constraint}
                \\
                    & N = 1 - l
                    \tag{time constraint}
                \\
                    & K = 2
                    \tag{capital constraint}
                \\
                \Rightarrow \quad \max_{l} \quad
                    & \frac{(z K^{a} ( 1-l )^{1-a} - G)^{1-b}}{1-b} + \frac{l^{1-d}}{1-d}
                \\
                \text{s.t.} \quad
                    & K = 2
        \end{align}
        %

    \end{itemize}

\end{frame}

\begin{frame}{Solving SPP}
\label{slide:Solving_SPP}
\begin{align}
        & \max_{l} \quad \frac{(z K^{a} ( 1-l )^{1-a} - G)^{1-b}}{1-b} + \frac{l^{1-d}}{1-d}
    \\
    \text{FOC:} \quad
        & \scriptsize
            \underbrace{( z  K^{a}( 1-l )^{1-a} - G )^{-b}}_{ \frac{( \cdot )^{1-b}}{1-b}}
            \times \underbrace{( 1-a )z K^{a}( 1-l )^{-a}}_{ zK^{a}( 1-l )^{1-a}}
            \times \underbrace{( -1 )}_{-l}
            + l^{-d} = 0
    \\
    G = 0 : \quad
        & \scriptsize
            z^{-b}K^{-ab}( 1-l )^{-b(1-a)} \times ( 1-a ) zK^{a}( 1-l )^{-a} = l^{-d}
    \\
        & \scriptsize
            ( 1-a ) z^{1-b} K^{a-ab} ( 1-l )^{-a - b+ a b} = l^{-d}
    \\
        & \scriptsize
            a = 1/2; \quad b = 2; \quad d = 3/2
    \\
    \text{Apply:} \quad
        & \scriptsize
            \frac{1}{2} z^{-1} K^{-\frac{1}{2}} ( 1-l )^{-\frac{3}{2}} = l^{-\frac{3}{2}} \Rightarrow ( \frac{1-l}{l} )^{ \frac{3}{2}} = \red{\frac{1}{2z \sqrt{K}} \equiv A(z, K)}
    \\
        & \scriptsize
        \frac{1-l}{l} = \left( A(z, K) \right)^{\frac{2}{3}} \Rightarrow (1 + \left( A(z, K) \right)^{\frac{2}{3}}) l = 1 \Rightarrow \red{l = \frac{1}{1 + A(z, k)^{\frac{2}{3}}}}
\end{align}
\end{frame}

\begin{frame}{Retrive aggregates}
\label{slide:Retrive_aggregates}
After solve for optimal leisure, $ l^{*} $,
    \begin{enumerate}
        \item Solve for optimal labor with $ N^{*} = 1 - l^{*} $
        \item Solve for optimal output with $ Y^{*} = z K^{a} (N^{*})^{1-a} $
        \item Solve for optimal consumption with $ C^{*} = Y^{*} $ ($G = 0$)
        \item Solve for optimal wage with $ w = MPN $
        \item Solve for optimal rental rate with $ r = MPK $
    \end{enumerate}
\end{frame}

\section{Distorting tax with Cobb-Douglas Production Function}
\label{sec:Distorting_tax_with_Cobb_Douglas_Production_Function}

\begin{frame}{Review of Distorting Tax}
\label{slide:Review_of_Distorting_Tax}
    \begin{enumerate}
        \item Labor tax violates the welfare theorems by introducing \alert{wedges} in consumption-leisure decisions
        \begin{itemize}
            \item $ MRS_{l, C} = w\underbrace{(1-t)}_{\text{wedges}} < w = MRT_{l, C} = MPN $
        \end{itemize}
        \item Gov collect labor tax revenue, $ R(t) = w t N $, to pay for gov spending ($G = R(t)$)
        \item Gov's objective may be \alert{pay fix amount of exogenous $ G $} or \alert{maximizing revenue $ R(t) $}
    \end{enumerate}


\end{frame}

\begin{frame}{Environment}
\label{slide:Environment}
    \begin{itemize}
        \item Production function: $ Y = z N^{a} $
        \item Utility: $U(C, N) = \ln C - b N$
        \item Labor tax is paid by households
    \end{itemize}

\end{frame}

\begin{frame}{Optimality Conditions}
\label{slide:Optimality_Conditions}
    \begin{itemize}
        \item $ D_{C}U(C, N) = \frac{1}{C} $
        \item $ D_{N}U(C, N) = -b $
        \item $ MRS_{N, C} = -bC $
        \item $ MRS_{l, C} = - MRS_{N, C} = bC $
        \item Consumer's optimality condition: $ MRS_{l, C} = bC = w(1-t) $
        \item Firms' optimality conditions:
        \begin{itemize}
            \item $ w = MPN = a z N^{a-1} \Rightarrow wN = a z N^{a} = a Y $
            \item $ \pi = Y - wN = (1-a) z N^{a} = (1-a)Y  $
        \end{itemize}

    \end{itemize}

\end{frame}

\begin{frame}{Solve for optimal labor given labor tax rate}
\label{slide:Solve_for_optimal_labor_given_labor_tax_rate}
%
\begin{align}
  b C & = w (1 - t)\\
  b [w (1 - t) N + \pi] & = w (1 - t)\\
  b [a z N^a (1 - t) + (1 - a) z N^a] & = a z N^{a - 1} (1 - t)\\
  z N^a b [a (1 - t) + (1 - a) ] & = a z N^{a - 1} (1 - t)\\
  N b [a (1 - t) + (1 - a) ] & = a (1 - t)\\
  N & = \frac{a (1 - t)}{b [a (1 - t) + (1 - a) ]}
\end{align}
%
\end{frame}

\begin{frame}{Labor tax revenue}
\label{slide:Labor_tax_revenue}
\begin{itemize}
    \item $ \displaystyle w(t) = a z N^{a - 1} = a z \left( \frac{a (1 - t)}{b [a (1 - t) + (1 - a) ]} \right)^{a - 1}$
    \item $ \displaystyle R(t) = w(t) N(t) t = a z N^{a} t = a z \left( \frac{a (1 - t)}{b [a (1 - t) + (1 - a) ]} \right)^{a} \times t $
    \item Recall: gov's objective may be \alert{pay exogenous $ G $} or \alert{maximizing revenue $ R(t) $}
    \begin{itemize}
        \item Given a $ G = \bar{G} $, there are two tax rates, $ t_{1} $ and $ t_{2} $, that can fulfill the same $ \bar{G} $
        \begin{itemize}
            \item $ t_{1} $ is less distortionary than $ t_{2} $
        \end{itemize}
        \item Maximizing $ R(t) $ requires $ \displaystyle \max_{t} R(t) = t a z \left( \frac{a (1 - t)}{b [a (1 - t) + (1 - a) ]} \right)^{a} $, which may be hard to solve
    \end{itemize}
    \item Either way, we can solve it numerically using Julia.
\end{itemize}
\end{frame}

\begin{frame}[t, fragile, allowframebreaks]{Julia Code}
\label{slide:Julia_Code}
\tiny
\inputminted[breaklines,breakanywhere,xleftmargin=3em,linenos]{julia}{../q2.jl}
\end{frame}


% \section{Appendix}
% \label{sec:Appendix}
%
% \appendix
% \begin{frame}[allowframebreaks]{References}
% \footnotesize
% \bibliographystyle{$BIB_STYLE}
% \bibliography{$BIBFILE}
% \end{frame}

\end{document}
